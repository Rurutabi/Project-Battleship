(()=>{"use strict";class e{constructor(e){this.shipLength=e>=0?e:-1}hits(){this.shipLength=this.shipLength-1,this.isSunk()}isSunk(){0===this.shipLength&&(this.shipLength="sunken ship")}}class t{constructor(e){this.player=e}}new class{subMarine=new e(2);destroyer=new e(3);battleShip=new e(4);cruiser=new e(5);aircraftCarrier=new e(6);draggedShipElement=null;player=new t(!0);ai=new t(!1);recordShipLocation=[];constructor(t,i){this.playerBoard=this.createArrayboard(t),this.aiBoard=this.createArrayboard(i),this.createBoard(),this.createShip(),this.dragShip(),this.playerTurn();const a=new e(4);this.placeShip(40,a),this.placeShip(58,this.subMarine),console.log(this.recordShipLocation[0].shipLocation),console.log(this.recordShipLocation),this.receiveAttack(40,this.playerBoard),this.receiveAttack(41,this.playerBoard),this.receiveAttack(43,this.playerBoard),this.receiveAttack(44,this.playerBoard),console.log(a)}createArrayboard(e){return Array.from({length:e},(()=>Array.from({length:e},(()=>0))))}playerTurn(){const e=document.querySelectorAll(".ai-cell"),t=document.querySelectorAll(".player-cell"),i=new Set;e.forEach(((e,a)=>{e.addEventListener("click",(()=>{if(!e.classList.contains("red")){let r;this.receiveAttack(a,this.aiBoard),e.classList.add("red");do{r=Math.floor(100*Math.random())}while(i.has(r)&&i.size<100);i.add(r),this.receiveAttack(r,this.playerBoard),t[r].classList.add("red")}}))}))}createBoard(){const e=document.createElement("div");e.classList.add("container"),document.body.appendChild(e);const t=document.createElement("div");t.classList.add("board-container","player-board"),e.appendChild(t);const i=document.createElement("div");i.classList.add("board-container","ai-board"),e.appendChild(i),i.classList.add("hide"),this.populateBoard(t),this.populateBoard(i)}populateBoard(e){for(let t=0;t<10;t++)for(let t=0;t<10;t++){const t=document.createElement("div");t.classList.add("cell"),e.classList.contains("player-board")?t.classList.add("player-cell"):t.classList.add("ai-cell"),e.appendChild(t)}}createShip(){const e=document.querySelector(".container"),t=document.createElement("div");t.classList.add("other-container"),e.appendChild(t),this.populateShip(this.subMarine.shipLength,t),this.populateShip(this.destroyer.shipLength,t),this.populateShip(this.aircraftCarrier.shipLength,t),this.populateShip(this.cruiser.shipLength,t),this.populateShip(this.battleShip.shipLength,t)}populateShip(e,t){const i=document.createElement("div");i.classList.add("ship-container"),i.setAttribute("id",`ship${e}-container`),i.style.gridTemplateColumns=`repeat(${e}, 50px)`,t.appendChild(i),i.draggable=!0;for(let t=0;t<e;t++){const t=document.createElement("div");t.classList.add("ship-cell"),this.colorFromLength(e,t),t.setAttribute("id",`${e}`),i.appendChild(t)}}dragShip(){const e=document.querySelectorAll(".player-cell");document.querySelectorAll(".ship-container").forEach((e=>{e.addEventListener("dragstart",(t=>{t.dataTransfer.setData("text/shipContainerID",e.id),t.dataTransfer.setData("text/shipCellRelativePos",t.offsetX)}))})),e.forEach(((t,i)=>{t.addEventListener("dragover",(e=>{e.preventDefault()})),t.addEventListener("drop",(t=>{const a=t.dataTransfer.getData("text/shipContainerID"),r=document.getElementById(a),s=r.querySelectorAll(".ship-cell"),o=parseInt(t.dataTransfer.getData("text/shipCellRelativePos"),10),n=Math.floor(o/50),l=i-n,h=l+s.length,d=h-l;if(this.getRow(l)===(h%10==0?this.getRow(h-1):this.getRow(h))&&!0===this.isCellPlaced(e,l,h))for(let t=l;t<l+s.length;t++)e[t].classList.add("placed"),this.colorFromLength(d,e[t]),r.remove()}))}))}isCellPlaced(e,t,i){for(let a=t;a<i;a++)if(e[a].classList.contains("placed"))return!1;return!0}placeShip(e,t){if(e<0||null===e)return"Index cant be negative number or null";let i=this.getRow(e),a=this.getCol(e);if(i>this.playerBoard.length)return"Index is larger than the board";if(!(a+t.shipLength<=this.playerBoard.length))return"out of bound";for(let r=0;r<t.shipLength;r++)this.playerBoard[i][a]=t.shipLength,a<=10?(this.recordShipLocation.push({shipLocation:e,ship:t}),e++,a++):(i++,a=0)}receiveAttack(e,t,i){let a=this.getRow(e),r=this.getCol(e);if(-1===t[a][r])return"Shot at the same locaiton";for(let t=0;t<this.recordShipLocation.length;t++)e===this.recordShipLocation[t].shipLocation&&this.recordShipLocation[t].ship.hits();t[a][r]=-1}getRow(e){return e>=100?Math.floor(e/10)-10:Math.floor(e/10)}getCol(e){return e%10}isWithinBound(e,t){return e>-1&&e<11&&t>-1&&t<11}colorFromLength(e,t){2===e&&t.classList.add("Midnightblue"),3===e&&t.classList.add("Brown"),4===e&&t.classList.add("Cadetblue"),5===e&&t.classList.add("Palevioletred"),6===e&&t.classList.add("Crimson")}getShipCoordinate(e,t){return e.shipCoordinate.indexOf(t)}}(10,10)})();