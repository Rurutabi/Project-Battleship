(()=>{"use strict";class t{constructor(t){this.shipLength=t>=0?Array.from({length:t},(()=>t)):-1,this.shipCoordinate=[]}hits(t){this.shipLength[t]=-1,this.isSunk()}isSunk(){this.shipLength.every((t=>-1===t))&&(this.shipLength="sunken ship")}}class e{constructor(t){this.player=t}}new class{subMarine=new t(2);destroyer=new t(3);battleShip=new t(4);cruiser=new t(5);aircraftCarrier=new t(6);draggedShipElement=null;player=new e(!0);ai=new e(!1);constructor(t,e){this.playerBoard=this.createArrayboard(t),this.aiBoard=this.createArrayboard(e),this.createBoard(),this.createShip(),this.dragShip(),this.playerTurn()}createArrayboard(t){return Array.from({length:t},(()=>Array.from({length:t},(()=>0))))}playerTurn(){const t=document.querySelectorAll(".ai-cell"),e=document.querySelectorAll(".player-cell"),i=new Set;t.forEach(((t,r)=>{t.addEventListener("click",(()=>{if(!t.classList.contains("red")){let a;this.receiveAttack(r,this.aiBoard),t.classList.add("red");do{a=Math.floor(100*Math.random())}while(i.has(a)&&i.size<100);i.add(a),this.receiveAttack(a,this.playerBoard),e[a].classList.add("red")}}))}))}createBoard(){const t=document.createElement("div");t.classList.add("container"),document.body.appendChild(t);const e=document.createElement("div");e.classList.add("board-container","player-board"),t.appendChild(e);const i=document.createElement("div");i.classList.add("board-container","ai-board"),t.appendChild(i),i.classList.add("hide"),this.populateBoard(e),this.populateBoard(i)}populateBoard(t){for(let e=0;e<10;e++)for(let e=0;e<10;e++){const e=document.createElement("div");e.classList.add("cell"),t.classList.contains("player-board")?e.classList.add("player-cell"):e.classList.add("ai-cell"),t.appendChild(e)}}createShip(){const t=document.querySelector(".container"),e=document.createElement("div");e.classList.add("other-container"),t.appendChild(e),this.populateShip(this.subMarine.shipLength.length,e),this.populateShip(this.destroyer.shipLength.length,e),this.populateShip(this.aircraftCarrier.shipLength.length,e),this.populateShip(this.cruiser.shipLength.length,e),this.populateShip(this.battleShip.shipLength.length,e)}populateShip(t,e){const i=document.createElement("div");i.classList.add("ship-container"),i.setAttribute("id",`ship${t}-container`),i.style.gridTemplateColumns=`repeat(${t}, 50px)`,e.appendChild(i),i.draggable=!0;for(let e=0;e<t;e++){const e=document.createElement("div");e.classList.add("ship-cell"),e.setAttribute("id",`${t}`),i.appendChild(e)}}dragShip(){const t=document.querySelectorAll(".player-cell");document.querySelectorAll(".ship-container").forEach((t=>{t.addEventListener("dragstart",(e=>{e.dataTransfer.setData("text/shipContainerID",t.id),e.dataTransfer.setData("text/shipCellRelativePos",e.offsetX)}))})),t.forEach(((e,i)=>{e.addEventListener("dragover",(t=>{t.preventDefault()})),e.addEventListener("drop",(e=>{const r=e.dataTransfer.getData("text/shipContainerID"),a=document.getElementById(r),s=a.querySelectorAll(".ship-cell"),n=parseInt(e.dataTransfer.getData("text/shipCellRelativePos"),10),h=Math.floor(n/50);if(0===h)for(let e=i;e<i+s.length;e++)t[e].classList.add("green"),a.remove();else{const e=i-h;for(let i=e;i<e+s.length;i++)t[i].classList.add("green"),a.remove()}}))}))}placeship(t,e){if(t<0||null===t)return"Index cant be negative number or null";let i=this.getRow(t),r=this.getCol(t);if(i>this.playerBoard.length)return"Index is larger than the board";if(!(r+e.shipLength.length<=this.playerBoard.length))return"out of bound";for(let a=0;a<e.shipLength.length;a++)this.playerBoard[i][r]=e.shipLength[a],r<=10?(e.shipCoordinate.push(t),t++,r++):(i++,r=0)}receiveAttack(t,e,i){let r=this.getRow(t),a=this.getCol(t);if(-1===e[r][a])return"Shot at the same locaiton";if(2===e[r][a]){const e=this.getShipCoordinate(this.subMarine,t);this.subMarine.hits(e)}if(3===e[r][a]){const e=this.getShipCoordinate(this.destroyer,t);this.destroyer.hits(e)}if(4===e[r][a]){const e=this.getShipCoordinate(this.battleShip,t);this.battleShip.hits(e)}if(5===e[r][a]){const e=this.getShipCoordinate(this.cruiser,t);this.cruiser.hits(e)}if(6===e[r][a]){const e=this.getShipCoordinate(this.aircraftCarrier,t);this.aircraftCarrier.hits(e)}if(void 0!==i&&e[r][a]===i.shipLength.length){const e=this.getShipCoordinate(i,t);i.hits(e)}e[r][a]=-1}getRow(t){return t>=100?Math.floor(t/10)-10:Math.floor(t/10)}getCol(t){return t%10}isWithinBound(t,e){return t>-1&&t<11&&e>-1&&e<11}getShipCoordinate(t,e){return t.shipCoordinate.indexOf(e)}}(10,10)})();